"0","set.seed(13031998)"
"0",""
"0","data_plot=data.frame()"
"0",""
"0","for(n in c(1,5,10,20)){"
"0","y=rpois(n,5)"
"0","y_stat=sum(y)"
"0",""
"0","f=function(x){exp(y_stat*x-n*exp(x)-(x**2)/(2*100))}"
"0","c=integrate(f,-Inf,Inf)$value"
"0","x_mean=integrate(function(x){x*f(x)},-Inf,Inf)$value/c"
"0","x2_mean=integrate(function(x){(x**2)*f(x)},-Inf,Inf)$value/c"
"0","s2=x2_mean-x_mean**2"
"0",""
"0","x_mean2=0"
"0","s22=100"
"0","for(i in 1:n){"
"0","  f=function(x){exp(y[i]*x-exp(x)-((x-x_mean2)**2)/(2*s22))}"
"0","  c_prev=integrate(f,-Inf,Inf)$value"
"0","  x_mean_prev=integrate(function(x){x*f(x)},-Inf,Inf)$value/c_prev"
"0","  x2_mean_prev=integrate(function(x){(x**2)*f(x)},-Inf,Inf)$value/c_prev"
"0","  s2_prev=x2_mean_prev-x_mean_prev**2"
"0","  "
"0","  x_mean2=x_mean_prev"
"0","  s22=s2_prev"
"0","  print(s22)"
"0","}"
"0",""
"0","f=function(x){exp(y_stat*x-n*exp(x)-(x**2)/(2*100))}"
"0","x=seq(x_mean-3*sqrt(s2),x_mean+3*sqrt(s2),l=1000)"
"0",""
"0","data_plot=rbind(data_plot,data.frame(x=x,"
"0","                                     fx=f(x)/c,"
"0","                                     gx=dnorm(x,x_mean,sqrt(s2)),"
"0","                                     hx=dnorm(x,x_mean2,sqrt(s22)),"
"0","                                     n=n))"
"0","}"
"1","[1]"
"1"," 0.2837965"
"1","
"
"1","[1]"
"1"," 0.1332927"
"1","
"
"1","[1]"
"1"," 0.07004157"
"1","
"
"1","[1]"
"1"," 0.04811817"
"1","
"
"1","[1]"
"1"," 0.03619453"
"1","
"
"1","[1]"
"1"," 0.02980069"
"1","
"
"1","[1]"
"1"," 0.1537136"
"1","
"
"1","[1]"
"1"," 0.08138876"
"1","
"
"1","[1]"
"1"," 0.05618455"
"1","
"
"1","[1]"
"1"," 0.04400018"
"1","
"
"1","[1]"
"1"," 0.03592452"
"1","
"
"1","[1]"
"1"," 0.02994199"
"1","
"
"1","[1]"
"1"," 0.025343"
"1","
"
"1","[1]"
"1"," 0.02203975"
"1","
"
"1","[1]"
"1"," 0.01949672"
"1","
"
"1","[1]"
"1"," 0.01744693"
"1","
"
"1","[1]"
"1"," 0.2214595"
"1","
"
"1","[1]"
"1"," 0.1079834"
"1","
"
"1","[1]"
"1"," 0.06940879"
"1","
"
"1","[1]"
"1"," 0.05061365"
"1","
"
"1","[1]"
"1"," 0.03929466"
"1","
"
"1","[1]"
"1"," 0.03243927"
"1","
"
"1","[1]"
"1"," 0.02778129"
"1","
"
"1","[1]"
"1"," 0.02430942"
"1","
"
"1","[1]"
"1"," 0.02177024"
"1","
"
"1","[1]"
"1"," 0.01959284"
"1","
"
"1","[1]"
"1"," 0.01778665"
"1","
"
"1","[1]"
"1"," 0.01626786"
"1","
"
"1","[1]"
"1"," 0.01497537"
"1","
"
"1","[1]"
"1"," 0.01387794"
"1","
"
"1","[1]"
"1"," 0.01291094"
"1","
"
"1","[1]"
"1"," 0.01207397"
"1","
"
"1","[1]"
"1"," 0.01134201"
"1","
"
"1","[1]"
"1"," 0.01068961"
"1","
"
"1","[1]"
"1"," 0.01011044"
"1","
"
"1","[1]"
"1"," 0.009578302"
"1","
"
"0","data_plot$n=factor(paste0('Tamanho da amostra:',data_plot$n),levels=paste0('Tamanho da amostra:',c(1,5,10,20)))"
"0",""
"0","ggplot(data_plot)+"
"0","  geom_line(aes(x=x,y=fx,linetype='Dist. exata'))+"
"0","  geom_line(aes(x=x,y=gx,linetype='Dist. aprox.',color='Ori.'))+"
"0","  geom_line(aes(x=x,y=hx,linetype='Dist. aprox.',color='Alt.'))+"
"0","  scale_linetype_manual('',values=c('dashed','solid'))+"
"0","  scale_color_manual('',values=c('red','blue'))+"
"0","  theme_bw()+"
"0","  facet_wrap(.~n,scales = 'free')"
